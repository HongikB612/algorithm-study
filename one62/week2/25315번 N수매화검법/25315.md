# [N수매화검법](https://www.acmicpc.net/problem/25315)

## 문제
화산파의 장로 우경은 새로운 무공 N수매화검법을 창안했다. N수매화검법은 이십사수매화검법을 발전시킨 검법으로 총 
$N$개의 베기(검으로 무언가를 베는 동작)로 이루어진다.

N수매화검법은 2차원 평면 상에서 펼치는 검법으로, 베기 
$i$는 점 
$s_i$에서 시작해 
$e_i$까지를 일직선으로 벤다. 이때 검이 지나는 경로를 베기 
$i$의 경로라고 한다.

또한 검법을 펼치는 동안 한 번 벨 때마다 심오한 원리로 내공을 소모하는데, 그 원리란 다음과 같다.

베기 
$i$에는 가중치 
$w_i$가 정해져 있으며, 베기 
$i$를 행하면 
$(m+1)\times w_i$만큼의 내공을 소모한다. 이때 
$m$은 베기 
$i$를 행한 순간에 아직 행하지 않은 베기 중 베기 
$i$와 경로가 교차하는 베기의 개수다.
N수매화검법을 완성하기 위해서는 검법을 이루는 
$N$개의 베기를 모두 정확히 한 번씩 행해야 하나, 그 순서는 상관이 없다. 장로 우경은 최소한의 내공만을 소모하여 N수매화검법을 완성하고 싶다. 그를 위해 N수매화검법을 완성하는 데 소모해야 하는 내공의 합의 최솟값을 구해주자.

## 입력
첫 번째 줄에 베기의 개수 
$N$이 주어진다. 
$(1\le N\le 2\, 500)$ 

다음 
$N$개의 줄에는 각 줄마다 베기 
$i$에 대해 
$s_i$, 
$e_i$의 좌표 
$(\mathit{sx}_i,\mathit{sy}_i)$, 
$(\mathit{ex}_i,\mathit{ey}_i)$와 가중치 
$w_i$가 공백으로 구분되어 차례로 주어진다. 
$(-10^9\le\mathit{sx}_i,\mathit{sy}_i,\mathit{ex}_i,\mathit{ey}_i\le 10^9$; 
$1\le w_i\le 10^9)$ 

주어지는 
$2N$개 점의 위치는 모두 서로 다르며, 어떤 세 점도 같은 직선 위에 있지 않다.

입력으로 주어지는 모든 수는 정수다.

## 출력
N수매화검법을 완성하는 데 소모해야 하는 내공의 합의 최솟값을 출력하라.

## 예제 입력 1 
```
3
1 1 3 3 1
1 3 3 1 2
6 7 8 9 1
```
## 예제 출력 1 
```
5
```

# 풀이
선분 교차 판정과 그리디 알고리즘을 이용하는 문제.

그리디의 난이도는 쉬운 편.  
선분 교차 판정도 '주어지는 점의 위치가 모두 서로 다르며 어떤 세 점도 같은 직선 위에 있지 않다'는 조건이 있어서 몇 가지 조건은 생략 가능하다.

### 선분 교차 판정
먼저, 두 선분이 서로 교차하는지 판정하기 위해 CCW(Counter Clock Wise)라는 알고리즘이 필요하다.  
CCW는 세 점이 있을 때 두 벡터의 방향을 판별하기 위한 것으로, 벡터의 외적을 이용한다.  

```(p2.x - p1.x) * (p3.y - p1.y) - (p3.x - p1.x) * (p2.y - p1.y)```  
p1과 p2를 잇는 벡터를 v1, p1과 p3을 잇는 벡터를 v2라 했을 때 v1보다 v2가 시계 방향에 있으면 위 식이 음수, 반시계 방향이면 양수로 나온다. 일직선상에 있으면 0이 나오는데 문제 조건상 고려할 필요는 없다.  

```
(ccw(c1.s, c1.e, c2.s) * ccw(c1.s, c1.e, c2.e) < 0
&& ccw(c2.s, c2.e, c1.s) * ccw(c2.s, c2.e, c1.e) < 0)
```
그리고 한 선분을 기준으로 다른 선분의 두 점이 서로 다른 방향에 있으면 두 선분이 서로 교차한다.  
어떤 세 점도 서로 같은 직선 위에 있지 않으므로, 
두 선분 모두 서로에 대해 위 식이 성립하면 두 선분은 교차한다.

### 그리디 알고리즘
서로 교차하는 베기가 있다면, 둘 중 더 가중치가 낮은 베기를 먼저 행하면 총 가중치가 낮아진다.  
서로 교차하지 않는다면 뭘 먼저 하든 상관 없다.  
따라서, 모든 베기를 가중치가 작은 순으로 정렬한 후, 각각의 베기에 대해 남은 베기 중 서로 교차하는 개수를 세어 $(m+1)\times w_i$의 m에 대입해 주면 된다.